#!/usr/bin/perl -w
# usage: echo "message body" | SUBJECT="New Slowroll update 20240830 released!" TOADDR=factory@lists.opensuse.org $0

$ENV{SUBJECT} or die;
$ENV{TOADDR} ||= 'bernhard+test@lsmod.de';
$ENV{FROMADDR} ||= 'bernhardout@lsmod.de';

$ENV{SUBJECT} =~ s/[^a-z0-9.,-]/\\$&/g; # escape special characters, because we pass it through bash below.

open(MAILPIPE, "|-", "mailx -r $ENV{FROMADDR} -s $ENV{SUBJECT} $ENV{TOADDR}") or die;

print MAILPIPE "Please note that this mail was generated by a script.\n\n";

while(<>) {
    print MAILPIPE $_;
}

